"Asignaciones_Equipos_Detalle As screen.'autoLayout_HeaderFooter_ver1.0'":
    Fill: =Color.White
    LoadingSpinnerColor: =App.Theme.Colors.Primary

    ScreenContainer4 As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.Light
        Fill: =RGBA(245, 245, 245, 1)
        Height: =Parent.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =16
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =16
        PaddingLeft: =16
        PaddingRight: =16
        PaddingTop: =16
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Width: =Parent.Width
        ZIndex: =1

        HeaderContainer4 As groupContainer.horizontalAutoLayoutContainer:
            DropShadow: =DropShadow.Light
            Fill: =RGBA(255, 255, 255, 1)
            FillPortions: =0
            Height: =75
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            ZIndex: =2

            Icon9 As icon.ArrowLeft:
                BorderColor: =App.Theme.Colors.Darker40
                Color: =App.Theme.Colors.Darker30
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(244, 244, 244, 1)
                Height: =40
                Icon: =Icon.ArrowLeft
                OnSelect: =Navigate(Asignaciones_Equipos)
                Width: =40
                ZIndex: =1

            Container8 As groupContainer.horizontalAutoLayoutContainer:
                DropShadow: =DropShadow.Light
                FillPortions: =0
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutGap: =3
                LayoutJustifyContent: =LayoutJustifyContent.End
                LayoutMinHeight: =50
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                ZIndex: =4

                ButtonCanvas4 As Button:
                    BasePaletteColor: =RGBA(8, 222, 8, 1)
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    OnSelect: |-
                        =If(Form2.Mode = FormMode.New,
                            Patch(
                                Asignaciones_1,
                                Defaults(Asignaciones_1),
                                {
                                    Id_Disp: DataCardValueIDDisp.Selected,
                                    Fecha_Asignacion: DataCardValueFechaAsig.SelectedDate,
                                    Firma: ImageFirma.Image,
                                    ResponsableP: {
                                        '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser", 
                                        Claims: "i:0#.f|membership|" & Lower(ComboBoxResp.Selected.Email), 
                                        Department:ComboBoxResp.Selected.Department, 
                                        DisplayName:ComboBoxResp.Selected.DisplayName,
                                        Email: ComboBoxResp.Selected.Email, 
                                        JobTitle:ComboBoxResp.Selected.JobTitle, 
                                        Picture:ComboBoxResp.Selected.Picture
                                    }
                                    ,
                                    ResponsableT: ComboBoxResp.Selected.DisplayName, 
                                    Activa: true
                                }
                            );
                            //If(SubmitForm(Form2),
                            Patch(Dispositivos,LookUp(Dispositivos,ID=VarIDDisp),
                                {
                                    Asignado:true
                                }
                            );
                            ClearCollect(
                                FiltroDispositivos,
                                Filter(
                                    [@Dispositivos],
                                    Or(Estatus.Value = "Activo", Estatus.Value = "Inactivo", Estatus.Value = "En revision")
                                )
                            );
                            Set(CantidadActivo, CountRows(Filter(FiltroDispositivos, Estatus.Value = "Activo")));
                            Set(CantidadInactivo, CountRows(Filter(FiltroDispositivos, Estatus.Value = "Inactivo")));
                            Set(CantidadEnRevision, CountRows(Filter(FiltroDispositivos, Estatus.Value = "En revision")));
                            Notify("Asignado con éxito",NotificationType.Success);
                            Reset(PenInput1);
                            Navigate(Asignaciones_Equipos);
                            //NewForm(Form2)
                           ,
                            If(EditForm(Form2),  
                        
                                Patch(
                                    Asignaciones_1,
                                    Defaults(Asignaciones_1),
                                    {
                                        Id_Disp: DataCardValueIDDisp.Selected,
                                        Fecha_Asignacion: DataCardValueFechaAsig.SelectedDate,
                                        Firma: ImageFirma.Image,
                                        ResponsableP: {
                                            '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser", 
                                            Claims: "i:0#.f|membership|" & Lower(ComboBoxResp.Selected.Email), 
                                            Department:ComboBoxResp.Selected.Department, 
                                            DisplayName:ComboBoxResp.Selected.DisplayName,
                                            Email: ComboBoxResp.Selected.Email, 
                                            JobTitle:ComboBoxResp.Selected.JobTitle, 
                                            Picture:ComboBoxResp.Selected.Picture
                                        }
                                        ,
                                        ResponsableT: ComboBoxResp.Selected.DisplayName
                                    }
                                ); 
                                Patch(Dispositivos,LookUp(Dispositivos,ID=VarIDDisp),
                                    {
                                        Asignado:true
                                    }
                                );
                                ClearCollect(
                                    FiltroDispositivos,
                                    Filter(
                                        [@Dispositivos],
                                        Or(Estatus.Value = "Activo", Estatus.Value = "Inactivo", Estatus.Value = "En revision")
                                    )
                                );
                                Notify("Actualizado con éxito", NotificationType.Success);
                                Navigate(Asignaciones_Equipos);
                                Set(CantidadActivo, CountRows(Filter(FiltroDispositivos, Estatus.Value = "Activo")));
                                Set(CantidadInactivo, CountRows(Filter(FiltroDispositivos, Estatus.Value = "Inactivo")));
                                Set(CantidadEnRevision, CountRows(Filter(FiltroDispositivos, Estatus.Value = "En revision")));
                            );
                            NewForm(Form2)
                        )
                    Text: |
                        =If(Form2.Mode = FormMode.New,
                            "Asignar",
                            "Reasignar"
                        )
                    Visible: =true
                    Width: =96
                    X: =0
                    Y: =0
                    ZIndex: =1

                ButtonCanvas6 As Button:
                    BasePaletteColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    OnSelect: |-
                        =//PENDIENTE SOLO ELIMINAR POR ID Y ACTUALIZAR SWITCH DISPOSITIVOS EN FALSE PARA ASIGNARLOS
                        //RemoveIf(Asignaciones_1,ID=ID);
                                Patch(Dispositivos,LookUp(Dispositivos,ID=VarIDDisp),
                                    {
                                        Asignado:false
                                    }
                                );
                        
                                Patch(Asignaciones_1,
                                    LookUp(Asignaciones_1, And(Id_Disp.Id = VarDispositivo.Id_Disp.Id, Activa = true)), 
                                    {
                                        Activa: false
                                    }
                                );
                        
                                Notify("Eliminado con éxito", NotificationType.Success);
                                Navigate(Asignaciones_Equipos);
                        
                                ClearCollect(
                                    FiltroDispositivos,
                                    Filter(
                                        [@Dispositivos],
                                        Or(Estatus.Value = "Activo", Estatus.Value = "Inactivo", Estatus.Value = "En revision")
                                    )
                                );
                                Set(CantidadActivo, CountRows(Filter(FiltroDispositivos, Estatus.Value = "Activo")));
                                Set(CantidadInactivo, CountRows(Filter(FiltroDispositivos, Estatus.Value = "Inactivo")));
                                Set(CantidadEnRevision, CountRows(Filter(FiltroDispositivos, Estatus.Value = "En revision")));
                            
                            NewForm(Form2)
                    Text: ="Desasignar"
                    Visible: |-
                        =//Comprueba que alguien tenga asignado este dispositivo
                        If( VarDispositivo.Activa = true,
                            true,
                            false
                        )
                    Width: =96
                    X: =0
                    Y: =0
                    ZIndex: =2

        MainContainer4 As groupContainer.verticalAutoLayoutContainer:
            DropShadow: =DropShadow.Light
            Fill: =RGBA(255, 255, 255, 1)
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            ZIndex: =3

            Form2 As form.PowerApps_CoreControls_Form:
                BorderColor: =App.Theme.Colors.Darker40
                DataSource: =Asignaciones_1
                DefaultMode: |
                    =//FormMode.Edit
                    /*If(IsBlank(LookUp(FiltroAsignaciones,Id_Disp.Id=VarIDDisp)),
                        FormMode.New,
                        FormMode.Edit
                    )*/
                    
                    
                    If(!IsBlank(LookUp(FiltroAsignaciones, And(Id_Disp.Id= VarIDDisp, Activa = true))) ,
                        FormMode.Edit,
                        If(IsBlank(LookUp(FiltroAsignaciones, Id_Disp.Id= VarIDDisp)),
                            FormMode.New 
                        )
                    )
                Item: |-
                    =//LookUp(Asignaciones_1,ID=2)
                    VarDispositivo
                    //LookUp(Asignaciones_1,ID=VarIDDisp)
                LayoutMinHeight: =250
                LayoutMinWidth: =400
                UseFluentV9Cards: =true
                ZIndex: =1

                Id_Disp_DataCard1 As typedDataCard.fluentV9ComboBoxEditCard:
                    BorderColor: =App.Theme.Colors.Darker40
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="Id_Disp"
                    Default: =ThisItem.Id_Disp
                    DisplayMode: |-
                        =//Parent.DisplayMode
                        DisplayMode.View
                    DisplayName: =DataSourceInfo([@Asignaciones_1],DataSourceInfo.DisplayName,Id_Disp)
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =70
                    Required: =false
                    Update: =DataCardValueIDDisp.Selected
                    Width: =444
                    X: =0
                    Y: =0
                    ZIndex: =1

                    DataCardKey13 As Text:
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Height: =22
                        Text: =Parent.DisplayName
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =Parent.Width - 48
                        Wrap: =false
                        X: =24
                        Y: =10
                        ZIndex: =1

                    DataCardValueIDDisp As Combobox.pcfdataset:
                        AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                        BorderStyle: =""
                        DefaultSelectedItems: |-
                            =//[Parent.Default]
                            [LookUp(Choices([@Asignaciones_1].Id_Disp),Id = VarIDDisp)]
                        DisplayMode: =DisplayMode.Edit
                        Height: =32
                        Items: =Choices([@Asignaciones_1].Id_Disp)
                        ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                        Width: =Parent.Width - 48
                        X: =24
                        Y: =DataCardKey13.Y + DataCardKey13.Height + 4
                        ZIndex: =2

                    ErrorMessage13 As Text:
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Height: =30
                        Text: =Parent.Error
                        Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =DataCardValueIDDisp.Y + DataCardValueIDDisp.Height
                        ZIndex: =3

                    StarVisible13 As Text:
                        Align: ='TextCanvas.Align'.Center
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Height: =20
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        X: =0
                        Y: =DataCardKey13.Y
                        ZIndex: =4

                Fecha_Asignacion_DataCard1 As typedDataCard.fluentV9DateEditCard:
                    BorderColor: =App.Theme.Colors.Darker40
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="Fecha_Asignacion"
                    Default: =ThisItem.Fecha_Asignacion
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@Asignaciones_1],DataSourceInfo.DisplayName,Fecha_Asignacion)
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =70
                    Required: =true
                    Update: =DataCardValueFechaAsig.SelectedDate
                    Width: =444
                    X: =1
                    Y: =0
                    ZIndex: =1

                    DataCardKey17 As Text:
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Height: =22
                        Text: =Parent.DisplayName
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =Parent.Width - 48
                        Wrap: =false
                        X: =24
                        Y: =10
                        ZIndex: =1

                    "DataCardValueFechaAsig As 'Date picker'":
                        AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                        BorderStyle: =""
                        DisplayMode: =Parent.DisplayMode
                        EndDate: =Date(Year(Today())+100, 12, 31)
                        Height: =32
                        SelectedDate: =Parent.Default
                        StartDate: =Date(1900, 1, 1)
                        ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                        Width: =Parent.Width - 48
                        X: =24
                        Y: =DataCardKey17.Y + DataCardKey17.Height + 4
                        ZIndex: =2

                    ErrorMessage17 As Text:
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Height: =30
                        Text: =Parent.Error
                        Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =DataCardValueFechaAsig.Y + DataCardValueFechaAsig.Height
                        ZIndex: =3

                    StarVisible17 As Text:
                        Align: ='TextCanvas.Align'.Center
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Height: =30
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        X: =0
                        Y: =DataCardKey17.Y
                        ZIndex: =4

                DataCard3 As typedDataCard.blankCard:
                    BorderColor: =App.Theme.Colors.Darker40
                    BorderStyle: =BorderStyle.Solid
                    DisplayMode: =DisplayMode.Edit
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =200
                    Width: =444
                    X: =2
                    Y: =0
                    ZIndex: =1

                    btn_reg_firma As Button:
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Height: =32
                        OnSelect: =Set(varisFrimaVisible, true)
                        Text: ="Registrar firma"
                        Width: =120
                        X: =40
                        Y: =40
                        ZIndex: =1

                Firma_DataCard1 As typedDataCard.fluentV9AddLargePictureCard:
                    BorderColor: =App.Theme.Colors.Darker40
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="Firma"
                    Default: =ThisItem.Firma
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@Asignaciones_1],DataSourceInfo.DisplayName,Firma)
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =50
                    Required: =false
                    Update: =Image8.Image
                    Width: =444
                    X: =0
                    Y: =1
                    ZIndex: =1

                    DataCardKey19 As Text:
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Height: =34
                        Text: =Parent.DisplayName
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =30
                        Y: =10
                        ZIndex: =1

                    Image8 As image:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        DisplayMode: =Parent.DisplayMode
                        Height: =AddPicture1.Height
                        Image: |-
                            =If(IsBlank(AddPicture1.Media), Parent.Default, AddPicture1.Media)
                            //Parent.Default
                        Tooltip: =Parent.DisplayName
                        Width: =AddPicture1.Width
                        X: =AddPicture1.X
                        Y: =AddPicture1.Y
                        ZIndex: =2

                    AddPicture1 As addMedia:
                        BorderColor: =App.Theme.Colors.Darker40
                        Color: =RGBA(0, 0, 0, 1)
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =200
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardKey19.Y + DataCardKey19.Height + 5
                        ZIndex: =3

                    ErrorMessage19 As Text:
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Height: =10
                        Size: =12
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =Image8.Y + Image8.Height
                        ZIndex: =4

                    StarVisible19 As Text:
                        Align: ='TextCanvas.Align'.Center
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Height: =DataCardKey19.Height
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        X: =0
                        Y: =DataCardKey19.Y
                        ZIndex: =5

                ResponsableP_DataCard1 As typedDataCard.fluentV9ComboBoxEditCard:
                    BorderColor: =App.Theme.Colors.Darker40
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="ResponsableP"
                    Default: =ThisItem.ResponsableP
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@Asignaciones_1],DataSourceInfo.DisplayName,ResponsableP)
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =70
                    Required: =false
                    Update: =ComboBoxResp.Selected
                    Width: =444
                    X: =1
                    Y: =1
                    ZIndex: =1

                    ComboBoxResp As combobox:
                        BorderColor: =App.Theme.Colors.Darker40
                        ChevronBackground: =App.Theme.Colors.Primary
                        ChevronDisabledBackground: =RGBA(166, 166, 166, 1)
                        ChevronDisabledFill: =RGBA(244, 244, 244, 1)
                        ChevronHoverBackground: =App.Theme.Colors.Darker10
                        ChevronHoverFill: =RGBA(255, 255, 255, 1)
                        DefaultSelectedItems: =Parent.Default
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        DisplayFields: =["DisplayName"]
                        Font: =App.Theme.Font
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =App.Theme.Colors.Lighter70
                        Items: |-
                            =//Office365Users.SearchUser({searchTerm:ComboBoxResp.SearchText}).DisplayName
                            Choices([@Asignaciones_1].ResponsableP)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =App.Theme.Colors.Darker30
                        SearchFields: =["DisplayName"]
                        SearchItems: =Choices(Asignaciones_1.ResponsableP,ComboBoxResp.SearchText)
                        SelectionFill: =App.Theme.Colors.Primary
                        SelectMultiple: =false
                        Size: =13
                        X: =40
                        Y: =40
                        ZIndex: =5

            ImageFirma As image:
                BorderColor: =App.Theme.Colors.Darker40
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Image: =PenInput1.Image
                ZIndex: =2

    Container6 As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.Light
        Fill: =RGBA(255, 255, 255, 1)
        Height: =Asignaciones_Equipos_Detalle.Height-1
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Visible: =varisFrimaVisible
        Width: =Asignaciones_Equipos_Detalle.Width-1
        X: =1
        Y: =1
        ZIndex: =2

        Container7 As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.Light
            FillPortions: =0
            Height: =60
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =30
            PaddingRight: =30
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            ZIndex: =1

            Icon10 As icon.ArrowLeft:
                BorderColor: =App.Theme.Colors.Darker40
                Color: =App.Theme.Colors.Darker30
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(244, 244, 244, 1)
                Height: =40
                Icon: =Icon.ArrowLeft
                OnSelect: =Set(varisFrimaVisible,false)
                Width: =40
                ZIndex: =1

            Icon10_1 As icon.ArrowLeft:
                BorderColor: =App.Theme.Colors.Darker40
                Color: =App.Theme.Colors.Darker30
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(244, 244, 244, 1)
                Height: =40
                Icon: =Icon.Check
                OnSelect: =Set(varisFrimaVisible,false)
                Width: =40
                ZIndex: =2

        PenInput1 As inkControl:
            BorderColor: =App.Theme.Colors.Darker40
            FillPortions: =1
            ZIndex: =2

